# 🏛️ חלק 3: תכנון REST API למערכת "ספרייה"

## 1. נימוק כללי לעיצוב

ה-API עוצב על פי עקרונות **RESTful**, תוך שימוש בשמות עצם רבים (Resources - משאבים) לייצוג הנתונים, ובמתודות HTTP (Verbs) לתיאור הפעולה הרצויה (CRUD).

## 2. Endpoints ופעולות

הטבלה מסכמת את כל נקודות הקצה (Endpoints) ופעולות המערכת הנדרשות:

| משאב (Resource) | מתודת HTTP | Endpoint (נקודת קצה) | פעולה עסקית / לוגית | נימוק (סוג CRUD) |
| :--- | :--- | :--- | :--- | :--- |
| **ספרים** | **GET** | `/api/books` | אחזור רשימת כל הספרים (כולל חיפוש/סינון) | **Read**: אחזור אוסף |
| **ספרים** | **POST** | `/api/books` | **יצירת** ספר חדש והוספתו למלאי | **Create**: יצירת משאב |
| **ספרים** | **PATCH** | `/api/books/{id}` | **עדכון חלקי** של פרטי ספר קיים (כותרת, מלאי וכו') | **Update**: שינוי משאב |
| **משאילים** | **POST** | `/api/patrons` | **רישום** משאיל חדש (הרשמה לספרייה) | **Create**: יצירת משאב |
| **השאלות** | **POST** | `/api/loans` | **השאלת ספר** (Check Out) – יצירת רשומת השאלה חדשה | **Create**: יצירת קשר זמני |
| **השאלות** | **PATCH** | `/api/loans/{loanId}/return` | **החזרת ספר** (Check In) – עדכון סטטוס ההשאלה ל"הוחזר" | **Update**: שינוי סטטוס עסקי |
| **קשר** | **GET** | `/api/patrons/{patronId}/loans` | בדיקה אילו ספרים **מושאלים כרגע** על ידי משאיל זה | **Read**: אחזור משאב יחסי |

## 3. מבני נתונים (DTOs) ושדות חובה

ה-DTOs מגדירים את הנתונים המועברים לבקשות ה-POST וה-PUT/PATCH.

### Book Creation DTO

| שדה | סוג | חובה (POST) | הערות |
| :--- | :--- | :--- | :--- |
| `title` | `String` | כן | שם הספר. |
| `isbn` | `String` | כן | מזהה בינלאומי ייחודי לספר. |
| `authorId` | `Long` | כן | מזהה המחבר. |
| `copiesAvailable` | `Integer` | כן | מספר עותקים זמינים להשאלה. |

### Patron Creation DTO

| שדה | סוג | חובה (POST) | הערות |
| :--- | :--- | :--- | :--- |
| `name` | `String` | כן | שם מלא של המשאיל. |
| `email` | `String` | כן | כתובת דוא"ל (חייבת להיות ייחודית). |

### Loan Creation DTO

| שדה | סוג | חובה (POST) | הערות |
| :--- | :--- | :--- | :--- |
| `bookId` | `Long` | כן | מזהה הספר המושאל. |
| `patronId` | `Long` | כן | מזהה המשאיל ששאל את הספר. |

